# EWMG Checkout

## Theme Setup

1. Copy `skin/frontend/base/default/vortex/css/_variables.less` and `skin/frontend/base/default/vortex/css/checkout.less` to your theme e.g. `skin/frontend/default/skywire/vortex/css/`.

2. Update `checkout.less` like so:

```
//
// Checkout
// --------


// Vendors

@import "../../../../base/default/vortex/css/vendors/_normalize.less";

// General

@import "_variables.less";
@import "../../../../base/default/vortex/css/_mixins.less";
@import "../../../../base/default/vortex/css/_debug.less";
@import "../../../../base/default/vortex/css/_styleguide.less";
@import "../../../../base/default/vortex/css/_general.less";
@import "../../../../base/default/vortex/css/_loader.less";
@import "../../../../base/default/vortex/css/_modal.less";
@import "../../../../base/default/vortex/css/_fonts.less";
@import "../../../../base/default/vortex/css/_form.less";
@import "../../../../base/default/vortex/css/_layout.less";
@import "../../../../base/default/vortex/css/_buttons.less";
@import "../../../../base/default/vortex/css/_header.less";
@import "../../../../base/default/vortex/css/_basket.less";
@import "../../../../base/default/vortex/css/_giftcard.less";
@import "../../../../base/default/vortex/css/_crosssell.less";
@import "../../../../base/default/vortex/css/_clickcollect.less";
@import "../../../../base/default/vortex/css/_register.less";
@import "../../../../base/default/vortex/css/_success.less";
@import "../../../../base/default/vortex/css/_amazonpayment";
@import "../../../../base/default/vortex/css/_errors";
@import "../../../../base/default/vortex/css/_cms";

```

3. Make the relevant changes to the `_variables.less` file for your theme. You can also copy across another LESS file that needs overriding in the same fashion.


4. Copy `skin/frontend/base/default/vortex/gruntfile.js` and `skin/frontend/base/default/vortex/package.json` to your theme directory (e.g. `skin/frontend/default/skywire/vortex/css/`) like above.

5. Then run on your terminal in your theme directory (e.g. `skin/frontend/default/skywire/vortex/css/`) run `npm install` and `grunt less` to compile the `checkout.css` file.


## Building the React app / developing locally

The checkout is built in the `app/code/community/Vortex/Checkout/js` folder using npm tooling. To build it, you simply run `npm install && npm build` and that will generate folders in `skin/frontend/base/default/vortex/checkout/static` and make those changes visible on the checkout within Magento. However continuously building to see a result can be quite cumbersome. 

Instead, it is possible to instantiate the checkout in ‘development mode’ and view changes on the react app outside of a Magento context. To see this, run `npm start` in `app/code/community/Vortex/Checkout/js`. This will create a local node server and boot the app. The app speaks to the Magento API still and is much easier to develop on, however it will lack any design changes made my layout xml inside of Magento. There are a few of caveats worth noting, that we seek to resolve in the future;

1. The local React environment instantiated by `npm start` will load on http://localhost:3000. As this is likely a different domain to your local EWMG project instance, you will need to make sure your CORs headers are set to allow cross origin for all HTTP verbs.

2. As all layouts are generated by Magento and the checkout css is inside Magento, it is currently required to manually copy the css  from within Magento to `app/code/community/Vortex/Checkout/js/src/checkout.css` _if_ you want to see css changes in ‘development mode’.

3. All local config is stored in `app/code/community/Vortex/Checkout/js/src/config.js`, you need to change those variables appropriately for you local environment.


## Additional Notes

Please ignore the contents of `skin/frontend/base/default/vortex/checkout/static/media` and `skin/frontend/base/default/vortex/checkout/static/css` as these are not used by created via the React build process.
